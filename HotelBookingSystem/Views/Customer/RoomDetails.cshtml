@model HotelBookingSystem.Models.Room

@{
    ViewData["Title"] = $"{Model.RoomName} Details";
}

<div class="container py-4">
    <!-- Header Section -->
    <div class="text-center mb-4">
        <h1 class="display-5 fw-bold text-gradient-primary mb-3">@Model.RoomName</h1>
        <div class="d-flex flex-wrap justify-content-center align-items-center gap-3">
            <span class="badge @(Model.IsAvailable ? "bg-success" : "bg-danger") fs-6 px-3 py-2">
                @(Model.IsAvailable ? "Available" : "Booked")
            </span>
            <span class="text-primary fw-bold fs-5">₹@Model.Rent <span class="text-muted fs-6">/ night</span></span>
            <span class="text-warning fw-bold fs-5">
                ⭐ @(Model.Ratings?.Any() == true ? Model.Ratings.Average(r => r.Stars).ToString("0.0") : "0.0")
                <span class="text-muted fs-6">(@Model.Ratings?.Count() ?? 0 reviews)</span>
            </span>
        </div>
    </div>

    <!-- Main Content -->
    <div class="row g-4">
        <!-- Image Gallery -->
        <!-- Image Gallery Section -->
        <div class="row g-4 mb-5">
            <!-- Main Image -->
            <div class="col-md-8">
                <div class="room-main-image rounded-4 overflow-hidden shadow-lg">
                    @if (Model.Image != null)
                    {
                        <img src="data:image;base64,@(Convert.ToBase64String(Model.Image))"
                             alt="@Model.RoomName"
                             class="img-fluid w-100 h-100 object-cover cursor-zoom"
                             data-bs-toggle="modal"
                             data-bs-target="#roomImageModal">
                    }
                    else
                    {
                        <img src="https://images.unsplash.com/photo-1582719478250-c89cae4dc85b?ixlib=rb-1.2.1&auto=format&fit=crop&w=800&q=80"
                             class="img-fluid w-100 h-100 object-cover"
                             alt="Room Image">
                    }
                </div>
            </div>

            <div class="col-lg-4">
                <div class="card border-0 shadow-sm rounded-4 overflow-hidden sticky-top" style="top: 20px;">
                    <div class="card-body p-4">
                        <h3 class="fw-bold mb-4">Book This Room</h3>

                        <div class="d-flex align-items-center justify-content-between mb-4">
                            <div>
                                <span class="d-block fw-bold fs-5">₹@Model.Rent</span>
                                <span class="text-muted small">per night</span>
                            </div>
                            <span class="badge @(Model.IsAvailable ? "bg-success" : "bg-danger") px-3 py-2">
                                @(Model.IsAvailable ? "Available" : "Booked")
                            </span>
                        </div>

                        <form>


                            @if (Model.IsAvailable)
                            {
                                <a asp-controller="Customer" asp-action="BookRoom" asp-route-roomId="@Model.RoomId"
                                   class="btn btn-primary w-100 py-3 rounded-pill fw-bold mb-3">
                                    <i class="fas fa-calendar-check me-2"></i>Book Now
                                </a>
                            }
                            else
                            {
                                <button class="btn btn-secondary w-100 py-3 rounded-pill fw-bold mb-3" disabled>
                                    <i class="fas fa-times-circle me-2"></i>Currently Unavailable
                                </button>
                            }

                            <a asp-controller="Customer" asp-action="Index" class="btn btn-outline-primary w-100 rounded-pill">
                                <i class="fas fa-arrow-left me-2"></i>Back to Rooms
                            </a>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
 
        <!-- Booking Card -->
    @*     <div class="col-lg-4"> *@
    @*         <div class="card border-0 shadow-sm rounded-4 overflow-hidden sticky-top" style="top: 20px;"> *@
    @*             <div class="card-body p-4"> *@
    @*                 <h3 class="fw-bold mb-4">Book This Room</h3> *@

    @*                 <div class="d-flex align-items-center justify-content-between mb-4"> *@
    @*                     <div> *@
    @*                         <span class="d-block fw-bold fs-5">₹@Model.Rent</span> *@
    @*                         <span class="text-muted small">per night</span> *@
    @*                     </div> *@
    @*                     <span class="badge @(Model.IsAvailable ? "bg-success" : "bg-danger") px-3 py-2"> *@
    @*                         @(Model.IsAvailable ? "Available" : "Booked") *@
    @*                     </span> *@
    @*                 </div> *@

    @*                 <form> *@
                

    @*                     @if (Model.IsAvailable) *@
    @*                     { *@
    @*                         <a asp-controller="Customer" asp-action="BookRoom" asp-route-roomId="@Model.RoomId" *@
    @*                            class="btn btn-primary w-100 py-3 rounded-pill fw-bold mb-3"> *@
    @*                             <i class="fas fa-calendar-check me-2"></i>Book Now *@
    @*                         </a> *@
    @*                     } *@
    @*                     else *@
    @*                     { *@
    @*                         <button class="btn btn-secondary w-100 py-3 rounded-pill fw-bold mb-3" disabled> *@
    @*                             <i class="fas fa-times-circle me-2"></i>Currently Unavailable *@
    @*                         </button> *@
    @*                     } *@

    @*                     <a asp-controller="Customer" asp-action="Index" class="btn btn-outline-primary w-100 rounded-pill"> *@
    @*                         <i class="fas fa-arrow-left me-2"></i>Back to Rooms *@
    @*                     </a> *@
    @*                 </form> *@
    @*             </div> *@
    @*         </div> *@
    @*     </div> *@
    @* </div> *@

    <!-- Room Details Section -->
    <div class="row mt-4">
        <div class="col-12">
            <div class="card border-0 shadow-sm rounded-4 overflow-hidden">
                <div class="card-body p-4">
                    <h3 class="fw-bold mb-4">Room Details</h3>

                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-4">
                                <h5 class="fw-bold mb-3"><i class="fas fa-info-circle text-primary me-2"></i>Description</h5>
                                <p class="text-muted">@Model.Description</p>
                            </div>

                        </div>

                        <div class="col-md-6">
                            <h5 class="fw-bold mb-3"><i class="fas fa-star text-warning me-2"></i>Amenities</h5>
                            <div class="row g-2">
                                <div class="col-6">
                                    <div class="d-flex align-items-center mb-3">
                                        <i class="fas fa-wifi text-primary me-2"></i>
                                        <span>High-speed WiFi</span>
                                    </div>
                                    <div class="d-flex align-items-center mb-3">
                                        <i class="fas fa-tv text-primary me-2"></i>
                                        <span>Smart TV</span>
                                    </div>
                                    <div class="d-flex align-items-center mb-3">
                                        <i class="fas fa-snowflake text-primary me-2"></i>
                                        <span>Air Conditioning</span>
                                    </div>
                                </div>
                                <div class="col-6">
                                    <div class="d-flex align-items-center mb-3">
                                        <i class="fas fa-coffee text-primary me-2"></i>
                                        <span>Coffee Maker</span>
                                    </div>
                                    <div class="d-flex align-items-center mb-3">
                                        <i class="fas fa-lock text-primary me-2"></i>
                                        <span>Safe Deposit Box</span>
                                    </div>
                                    <div class="d-flex align-items-center mb-3">
                                        <i class="fas fa-bath text-primary me-2"></i>
                                        <span>Private Bathroom</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Reviews Section -->
    <div class="row mt-4">
        <div class="col-12">
            <div class="card border-0 shadow-sm rounded-4 overflow-hidden">
                <div class="card-body p-4">
                    <div class="d-flex justify-content-between align-items-center mb-4">
                        <h3 class="fw-bold mb-0">Customer Reviews</h3>
                        <div>
                            <span class="text-warning fw-bold fs-4">
                                ⭐ @(Model.Ratings?.Any() == true ? Model.Ratings.Average(r => r.Stars).ToString("0.0") : "0.0")
                            </span>
                            <span class="text-muted">(@Model.Ratings?.Count() ?? 0 reviews)</span>
                        </div>
                    </div>

                    @if (Model.Ratings != null && Model.Ratings.Any())
                    {
                        foreach (var rating in Model.Ratings.OrderByDescending(r => r.RatingId))
                        {
                            <div class="review-card mb-4 p-4 rounded-3">
                                <div class="d-flex justify-content-between mb-2">
                                    <h5 class="fw-bold mb-0">@rating.CustomerName</h5>
                                    <div class="text-warning">
                                        @for (int i = 0; i < rating.Stars; i++)
                                        {
                                            <i class="fas fa-star"></i>
                                        }
                                        @for (int i = rating.Stars; i < 5; i++)
                                        {
                                            <i class="far fa-star"></i>
                                        }
                                    </div>
                                </div>
                                <p class="mb-0">@rating.Review</p>
                            </div>
                        }
                    }
                    else
                    {
                        <div class="text-center py-4">
                            <i class="far fa-comment-dots fa-3x text-muted mb-3"></i>
                            <h5 class="fw-bold">No reviews yet</h5>
                            <p class="text-muted">Be the first to review this room</p>
                        </div>
                    }

                    <!-- Add Review Form -->
                    <div class="mt-5">
                        <h4 class="fw-bold mb-4">Add Your Review</h4>
                        <form asp-action="AddRating" asp-controller="Customer" method="post">
                            <input type="hidden" name="RoomId" value="@Model.RoomId" />

                            <div class="mb-4">
                                <label class="form-label fw-bold">Your Rating</label>
                                <div class="star-rating">
                                    <input type="radio" id="star5" name="Stars" value="5" />
                                    <label for="star5" title="5 stars"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="star4" name="Stars" value="4" />
                                    <label for="star4" title="4 stars"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="star3" name="Stars" value="3" checked />
                                    <label for="star3" title="3 stars"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="star2" name="Stars" value="2" />
                                    <label for="star2" title="2 stars"><i class="fas fa-star"></i></label>
                                    <input type="radio" id="star1" name="Stars" value="1" />
                                    <label for="star1" title="1 star"><i class="fas fa-star"></i></label>
                                </div>
                            </div>

                            <div class="mb-4">
                                <label class="form-label fw-bold">Your Review</label>
                                <textarea name="Review" class="form-control rounded-3" rows="4" placeholder="Share your experience..."></textarea>
                            </div>

                            <button type="submit" class="btn btn-primary rounded-pill px-4 py-2">
                                <i class="fas fa-paper-plane me-2"></i>Submit Review
                            </button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Image Modal -->
<div class="modal fade" id="roomImageModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-xl modal-dialog-centered">
        <div class="modal-content bg-transparent border-0">
            <div class="modal-header border-0">
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body text-center p-0">
                <img src="data:image;base64,@(Convert.ToBase64String(Model.Image))"
                     class="img-fluid rounded-3"
                     alt="@Model.RoomName">
            </div>
        </div>
    </div>
</div>

<!-- CSS Styles -->
<style>
    :root {
        --primary-color: #4e66f8;
        --primary-hover: #3a56f7;
    }

    .text-gradient-primary {
        background: linear-gradient(90deg, var(--primary-color), #6c47ff);
        -webkit-background-clip: text;
        background-clip: text;
        -webkit-text-fill-color: transparent;
    }

    .room-gallery {
        height: 350px;
        background-color: #f8f9fa;
    }

    .room-thumb {
        transition: all 0.3s ease;
    }

        .room-thumb:hover {
            transform: scale(1.02);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

    .cursor-zoom {
        cursor: zoom-in;
    }

    .object-cover {
        object-fit: cover;
    }

    .rounded-4 {
        border-radius: 1rem !important;
    }

    .sticky-top {
        position: sticky;
        z-index: 1;
    }

    .review-card {
        background-color: #f8f9fa;
        border-left: 4px solid var(--primary-color);
    }

    .star-rating {
        direction: rtl;
        display: inline-block;
    }

        .star-rating input[type=radio] {
            display: none;
        }

        .star-rating label {
            color: #ddd;
            font-size: 24px;
            padding: 0 3px;
            cursor: pointer;
        }

        .star-rating input[type=radio]:checked ~ label {
            color: #ffcc00;
        }

        .star-rating label:hover,
        .star-rating label:hover ~ label {
            color: #ffcc00;
        }

    .btn-primary {
        background-color: var(--primary-color);
        border-color: var(--primary-color);
    }

        .btn-primary:hover {
            background-color: var(--primary-hover);
            border-color: var(--primary-hover);
        }

    .btn-outline-primary {
        color: var(--primary-color);
        border-color: var(--primary-color);
    }

        .btn-outline-primary:hover {
            background-color: var(--primary-color);
            color: white;
        }
</style>

<!-- Font Awesome for icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">